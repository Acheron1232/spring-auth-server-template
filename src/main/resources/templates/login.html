<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login</title>
    <link rel="stylesheet" href="/front/style.css">
</head>
<body>
<main class="auth-shell">
    <div class="auth-bg" aria-hidden="true"></div>
    <section class="auth-box auth-card" aria-label="Login">
        <header class="auth-header">
            <div class="auth-mark" aria-hidden="true"></div>
            <h1 class="auth-title">Welcome back</h1>
            <p class="auth-subtitle">Sign in to continue</p>
        </header>

        <div class="message is-success" th:if="${param.registered}" role="status" aria-live="polite">
            Account created! Please sign in.
        </div>
        <div class="message is-error" th:if="${param.error}" role="alert" aria-live="assertive">
            Invalid credentials. Please try again.
        </div>

        <form class="auth-form" data-auth-form action="/login" method="post" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <div class="field">
                <label class="field-label" for="username">Username</label>
                <input id="username" type="text" name="username" class="auth-input" placeholder="yourname" autocomplete="username" required minlength="3">
                <div class="field-hint" data-field-error="username" aria-live="polite"></div>
            </div>

            <div class="field">
                <label class="field-label" for="password">Password</label>
                <div class="field-with-action">
                    <input id="password" type="password" name="password" class="auth-input" placeholder="••••••••" autocomplete="current-password" required minlength="8">
                    <button class="field-action" type="button" data-toggle-password aria-label="Show password">Show</button>
                </div>
                <div class="field-hint" data-field-error="password" aria-live="polite"></div>
            </div>

            <div class="field" id="twofa-field">
                <label class="field-label" for="twofacode">
                    2FA code
                    <span style="color:var(--muted);font-weight:400"> — leave blank if not enabled</span>
                </label>
                <input id="twofacode" type="text" name="2facode" class="auth-input" inputmode="numeric"
                       placeholder="123456" autocomplete="one-time-code" minlength="6" maxlength="6">
                <div class="field-hint" data-field-error="2facode" aria-live="polite"></div>
            </div>

            <button type="submit" class="auth-button" data-submit>
                <span class="btn-label">Sign in</span>
                <span class="btn-spinner" aria-hidden="true"></span>
            </button>

            <div class="message" role="status" aria-live="polite"></div>
        </form>

        <div class="auth-divider"><span>or</span></div>

        <div class="oauth-grid">
            <a href="/oauth2/authorization/google" class="oauth-btn oauth-btn--google" aria-label="Login with Google">
                <img src="https://www.svgrepo.com/show/355037/google.svg" alt="" aria-hidden="true">
                Continue with Google
            </a>
            <a href="/oauth2/authorization/github" class="oauth-btn oauth-btn--github" aria-label="Login with GitHub">
                <img src="https://www.svgrepo.com/show/512317/github-142.svg" alt="" aria-hidden="true">
                Continue with GitHub
            </a>
        </div>

        <nav class="auth-links" aria-label="Login links">
            <a href="/registration">Create an account</a>
            <a href="/reset_password">Reset password</a>
        </nav>
    </section>
</main>

<script defer src="/front/script.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Create Account</title>
    <link rel="stylesheet" href="/front/style.css">
</head>
<body>
<main class="auth-shell">
    <div class="auth-bg" aria-hidden="true"></div>
    <section class="auth-box auth-card" aria-label="Registration">
        <header class="auth-header">
            <div class="auth-mark" aria-hidden="true"></div>
            <h1 class="auth-title">Create your account</h1>
            <p class="auth-subtitle">Secure sign-up with optional MFA</p>
        </header>

        <form class="auth-form" action="/registration" method="post"
              th:object="${registrationRequest}" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

            <div class="field">
                <label class="field-label" for="reg_username">Username</label>
                <input id="reg_username" type="text" th:field="*{username}"
                       class="auth-input" th:classappend="${#fields.hasErrors('username')} ? ' is-error'"
                       placeholder="yourname" autocomplete="username" required minlength="3" maxlength="32">
                <div class="field-hint is-error" th:if="${#fields.hasErrors('username')}"
                     th:errors="*{username}" aria-live="polite"></div>
            </div>

            <div class="field">
                <label class="field-label" for="reg_email">Email</label>
                <input id="reg_email" type="email" th:field="*{email}"
                       class="auth-input" th:classappend="${#fields.hasErrors('email')} ? ' is-error'"
                       placeholder="name@example.com" autocomplete="email" required>
                <div class="field-hint is-error" th:if="${#fields.hasErrors('email')}"
                     th:errors="*{email}" aria-live="polite"></div>
            </div>

            <div class="field">
                <label class="field-label" for="reg_password">Password</label>
                <div class="field-with-action">
                    <input id="reg_password" type="password" th:field="*{password}"
                           class="auth-input" th:classappend="${#fields.hasErrors('password')} ? ' is-error'"
                           placeholder="At least 8 characters" autocomplete="new-password" required minlength="8">
                    <button class="field-action" type="button" data-toggle-password aria-label="Show password">Show</button>
                </div>
                <div class="field-hint is-error" th:if="${#fields.hasErrors('password')}"
                     th:errors="*{password}" aria-live="polite"></div>
                <div class="field-meta">
                    <div class="strength" data-strength aria-hidden="true">
                        <span class="strength-bar"></span>
                    </div>
                    <span class="strength-label" data-strength-label> </span>
                </div>
            </div>

            <section class="mfa-card" aria-label="Multi-factor authentication">
                <div class="mfa-head">
                    <div>
                        <h2 class="mfa-title">Multi-factor authentication</h2>
                        <p class="mfa-subtitle">Recommended. Scan the QR code with your authenticator app after registration.</p>
                    </div>
                    <label class="toggle" for="mfa_enabled">
                        <input type="checkbox" value="true" th:field="*{mfaEnabled}" id="mfa_enabled" data-mfa-toggle>
                        <span class="toggle-ui" aria-hidden="true"></span>
                        <span class="toggle-label">Enable MFA</span>
                    </label>
                </div>
                <div class="mfa-body" data-mfa-panel hidden>
                    <p class="mfa-note">MFA will be configured after account creation. You will be prompted to scan a QR code on first login.</p>
                </div>
            </section>

            <button type="submit" class="auth-button" data-submit>
                <span class="btn-label">Create account</span>
                <span class="btn-spinner" aria-hidden="true"></span>
            </button>

            <div class="message" role="status" aria-live="polite"></div>
        </form>

        <div class="auth-divider"><span>or</span></div>

        <div class="oauth-grid">
            <a href="/oauth2/authorization/google" class="oauth-btn oauth-btn--google" aria-label="Login with Google">
                <img src="https://www.svgrepo.com/show/355037/google.svg" alt="" aria-hidden="true">
                Continue with Google
            </a>
            <a href="/oauth2/authorization/github" class="oauth-btn oauth-btn--github" aria-label="Login with GitHub">
                <img src="https://www.svgrepo.com/show/512317/github-142.svg" alt="" aria-hidden="true">
                Continue with GitHub
            </a>
        </div>

        <nav class="auth-links" aria-label="Registration links">
            <a href="/login">Already have an account? Sign in</a>
        </nav>
    </section>
</main>

<script defer src="/front/script.js"></script>
</body>
</html>